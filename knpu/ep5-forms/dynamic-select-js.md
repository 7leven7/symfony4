# Dynamic Select Js

Coming soon...

We finished the heavy lifting here. Our form is now really smart. Thanks to these event listeners, no matter what data we start with or what data we submit for the location field, the specific location name field is changed correctly so that we're able to save, um, the values from that drop down. So the only thing we need to do now is add some fancy javascript. Let me change this location dropped down to a star. We need to have an Ajax call that goes and changes this to these stars for changes to the planets. Then it changes it to planets. So in an article admin controller, I'm going to add a new end point for this. I'm gonna call a public function, get specific location, select. And I'm going to type in symphonies request object. The idea is this is going to take, we're going to send the location that was just selected to this end point and it is going to return the new html needed for the specific location name. So above this I'll put the normal out route, we'll call it slash admin slash articles slash location dash select. And I'll give it a name equals

admin article. Location. Select inside the logic is fairly simple. We're gonna. Create a new article, object articles, new article. They were going to set the location onto that. So the way I'm going to do this is when we make the age x request, we're going to add a query parameter question mark. Location equals. So here I can say article set location, and then request Arrow Query Arrow get

location

we're doing here is we're not going to save this article object, we're just creating this article objects so that we can create the form for that. So for me, equals this Arrow create for him article form type class and pass that article. We know that internally thanks to our event listeners, specifically our preset data event listener. This form will now be set up correctly, the specific name part based on wherever the location is that was sent up. So now we're just gonna return were ultimately to return. Here is just that one field. But first I'm gonna check to see if there is no field, there's no refield, just return an empty response. What I literally mean is, if not form Arrow has specific location, name and repairing a new response. The one from htd foundation with no content and we're returning at two. Oh, four status code to have for just means it was successful, but we have no content descend back and remember we might not have a specific location name because if there's no location set or if the location is interstellar space,

homework, because they need to have like a. there's a switch that's broken on the furnace and then he said that the theater thing, Murphy's select interstellar space. There's no options either. If we do have that form, if we do have that field, we want to render it, so we're actually going to return a. we're going to render a template. It's gonna be a bit of a strange template or the article underscore admin. We're going to call this one slash specific location. Name that each month twig. Then pass in the form like normal article form set to form Arrow, create view. All right, then I'll put my cursor on that name or do a alt enter to create that twig template. But this is not going to be a full page. We're literally going to say form underscore, row article form that specific location name, and that's it. This end endpoint is just going to return this specific location name and we should already be able to try this. If we kind of copied this, you were out. I'll open a new tab, low close colon, 8,000 slash admin slash article slash select question mark. Location Equals Star

and Yep, looks good. We get the star dropdown for your solar system. We get the solar system dropdown. Excellent.

All right, so next, in order to power our javascript, go to underscore form that html twig, our javascript is going to, is going to need to know a few things. It's going to need to be able to find the location field because it's going to need to know when that changes and it's also gonna need to know where it is going to need to know where this specific location name field is so that it can change it dynamically. So to the location field, I'm going to pass a variable thing and we're actually going to set some special attributes on this specifically. I'm going to set one call data dash specific location url set to path of admin article location. Select one setting a data attributes that we can read that in javascript instead of hard coding the Url. Then we'll just going to set a class on this called js article form location. That's going to be something that we'll use to find this field. So we're going to attach the javascript. The second thing I'm gonna do is I'm going to surround my specific location name feel with a new Dev with it, with aj s dash specific location, target Dev, and then I'll just indent that

and now we're ready for the Java script. Open up your public directory and remember in this application we're not using webpack encore yet, so we just have really simple javascript. Bring a new javascript file called admin article form, and then I'm actually going to paste in some javascript that I already prepared. You can download this javascript, you can get this javascript at the Vba code block on this page. Now before we talk about this, we need, let's go ahead and include it from our two templates. So we can't include javascript directly from underscore formed at eight smart twig because that's an included template. So we'll go into our edit that age. My tweak, I'm override blocked Javascripts, call the parent function and then want a script tag source equals adamant Article Form Dot js. I'll copy that and I'll do, I'll go to the new template. We already over the, a javascript block there. So what does copy and that javascript? Alright, so this is unless we mess something up, this should work, but let's go and actually look at this admin article forms because you have the entire flow is susie. We're just using jquery and here we have a document not ready. The first thing I do is I select the two fields. I slept the location select,

which is going to be the actual select element, uh, for the location. And then I also select these specific location target that is the div that is around our specific location. Name field.

Yeah.

So then locations like on change, what we do is we make an Ajax call and for the you were out. We read that data attribute that reset the data specific location, you well

off of our locations. So that's why we. That data attribute was a nice way to get that for the data. I set location to location, select that vowel, so whatever the value is of the selected location, that will pass that as a query parameter. Then on success, we're going to get back the html of the new form field, but if we don't get back html, that means that we've selected an option that should not have another dropdown. So we do is we actually look inside of these specific location target. That's the live around there and we try to find a select element. If there is one and we removed that, that's to make sure that that doesn't get submitted. Then on the specific location target itself, we add a bootstrap class called d that's for display. None. That's going to make sure that the entire, the entire element is hidden, including the label, not just the select element, but if there is some hd mouth, there is a field. Then we're going to find that specific location target. We're going to put the entire row into that html and we're gonna. Make sure that our display non-class is removed so you can see it's sort of straightforward, but there are a lot of moving pieces. So let's check this out. I'm going to refresh the edit page.

Currently we are on the star, but on my console to mix, there's no airs. Change this to the solar system and yes we got it and if we change this to interstellar space, nice. It is gone. And specifically what'd you can see here is that that form group is still there with this specific location name, but it's just the label. Because of the display, none. It's been replaced some changes back to the solar system now. Yep. R, d nine is gone and now we have a forum group with the actual select inside of it. So let's just make sure this actually works. Let's go to the solar system. Let's change this to earth. It update and yeah, we've got it. Let's go back to the star in. That saves just fine. That's the end result. Works really well, but it is a bit complicated setup. Now there are a few small details we need to clean up before are fully done and we'll go ahead and clean those up next.